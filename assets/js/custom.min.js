/* Start Cookie's Get And Set Function  */
function setCookie(name,value,days) {
	var expires = "";
    if (days) {
		var date = new Date();
        date.setTime(date.getTime() + (days*13*60*60*1000));
        expires = "; expires=" + date.toUTCString();
    }
    document.cookie = name + "=" + (value || "")  + expires + "; path=/";
}
function getCookie(name) {
	var nameEQ = name + "=";
    var ca = document.cookie.split(';');
    for(var i=0;i < ca.length;i++) {
		var c = ca[i];
        while (c.charAt(0)==' ') c = c.substring(1,c.length);
        if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
    }
    return null;
}

/* End Cookie's Get And Set Function  */

/* Start Birthday Modal Code  */
if(getCookie('close_modal') == null){
	($('#show_modal').data('show_modal') == 'show') ? $('#birthday_modal').modal('show') : $('#birthday_modal').modal('hide') ;
}
$('body').click(function(event){
	if($('#show_modal').data('show_modal') == 'show'){
		setTimeout(function() {
			if(!$('#birthday_modal').hasClass('in')){
				// if($('#close_forever').is(':checked')){
				setCookie('close_modal','close modal true',0.75);
				// }
			}
		}, 500);	
	}
});
$('#birthday_modal_close').click(function(){
	if($('#show_modal').data('show_modal') == 'show'){
		if($('#close_forever').is(':checked')){
			setCookie('close_modal','close modal true',0.75);
		}
		$('#birthday_modal').modal('hide');
	}
});

/* End Birthday Modal Code  */

$(document).ready(function(){"use strict";var e=$("body");$(function(){$(".preloader").fadeOut(),$("#side-menu").metisMenu()}),$(".open-close").on("click",function(){e.toggleClass("show-sidebar").toggleClass("hide-sidebar"),$(".sidebar-head .open-close i").toggleClass("ti-menu")}),$(function(){$('[data-toggle="tooltip"]').tooltip()}),$(function(){$('[data-toggle="popover"]').popover()}),$(".list-task li label").on("click",function(){$(this).toggleClass("task-done")}),$(".settings_box a").on("click",function(){$("ul.theme_color").toggleClass("theme_block")}),$(".collapseble").on("click",function(){$(".collapseblebox").fadeToggle(350)}),$(".chat-list").slimScroll({height:"100%",position:"right",size:"0px",color:"#dcdcdc"}),e.trigger("resize"),$(".visited li a").on("click",function(e){$(".visited li").removeClass("active");var i=$(this).parent();i.hasClass("active")||i.addClass("active"),e.preventDefault()}),$("#to-recover").on("click",function(){$("#loginform").slideUp(),$("#recoverform").fadeIn()}),$(".navbar-toggle").on("click",function(){$(".navbar-toggle i").toggleClass("ti-menu").addClass("ti-close")})});$(document).ready(function(){$(".salary-update").click(function(){$(".btn-toggel").fadeIn(1000).fadeOut(2000)})});
/* Sidebar Menu open close code Start*/
function getCookie(key) {
    var keyValue = document.cookie.match('(^|;) ?' + key + '=([^;]*)(;|$)');
    return keyValue ? keyValue[2] : null;
}
$(document).ready(function(){
	var keyValue = getCookie("menu");
	if(keyValue == 'open'){
		$('body').addClass('sidebar-open');
		$('.sidebar').addClass('sidebar-active');
		$('.button_menu').addClass('active');
	}else{
		$('#side-menu li .sub-has-menu').removeClass('in').attr('aria-expanded',false).attr('style',"");
	}
});
$('.numeric').keyup(function() {
    this.value = this.value.replace(/[^0-9\.]/g, '');
});
$('#change_pc_id').keyup(function(){
    if(($(this).val().length) > 2){$('#change_pc_id').addClass('error'); }else{$('#change_pc_id').removeClass('error'); };
});
var base_url = $("#js_data").data('base-url');
$('#btn-change_id').click(function(){
	$('.preloader.preloader-2').attr('style', 'display:block !important');
    var change_pc_id = $('#change_pc_id').val();
    var emp_id = $('#emp_id').val();
	
    var data = {
        'emp_id': emp_id,
        'pc_id': change_pc_id,
    };
	if(emp_id != '' && change_pc_id.length <= 2){
		$.ajax({
			url: base_url+"pc_issue/changPC_id",
			type: "post",
			data: data ,
			success: function (response) {
				var obj = JSON.parse(response);
				if(obj.error_code == 0){
					$('.idofpc').text($('#change_pc_id').val());
					$('#idofpc_1').text($('#change_pc_id').val());
					$('#change_pc_id').val('');
					$('.msg-container').html(obj.message);
					$('.msg-container .msg-box').attr('style','display:block');
					setTimeout(function() {
						$('.msg-container .msg-box').attr('style','display:none');
					}, 6000);
					$('.preloader.preloader-2').attr('style', 'display:none !important');
				}else{
					$('.msg-container').html(obj.message);
					$('.msg-container .msg-box').attr('style','display:block');
					setTimeout(function() {
						$('.msg-container .msg-box').attr('style','display:none');
					}, 6000);
					$('.preloader.preloader-2').attr('style', 'display:none !important');
				}
			},
		});
	}else{
		if((change_pc_id.length) > 2){$('#change_pc_id').addClass('error'); }else{$('#change_pc_id').removeClass('error'); };
		if(emp_id == ''){$('#emp_id').addClass('error'); }else{$('#emp_id').removeClass('error'); };
        $('.preloader.preloader-2').attr('style', 'display:none !important');
		return false;
	}
});
$('.button_menu').click(function(){
	$('body').toggleClass('sidebar-open');
	$('.sidebar').toggleClass('sidebar-active');
	if($(this).hasClass('active')){
		$('#side-menu li .sub-has-menu').removeClass('in').attr('aria-expanded',false).attr('style',"");	
		document.cookie = 'menu = close;';
		// delete_cookie('menu');
	}else{
		$('.menu-a.active').closest('li').addClass('active').find('.sub-has-menu').addClass('in').attr('aria-expanded',true).attr('style',"display:block");
		document.cookie = 'menu = open;';
	}
	$(this).toggleClass('active');
});
$('#side-menu li a').click(function(){
	$('body').addClass('sidebar-open');
	$('.sidebar').addClass('sidebar-active');
	$('.button_menu').addClass('active');
	document.cookie = 'menu = open;';
});
/* Sidebar Menu open close code End*/

/* Mobile Menu open close code Start*/
$('.header-btn').click(function(){
	$('.mb-header').toggleClass('header-toggle');
	$(this).toggleClass('active');
	$('body').toggleClass('fixed-body');
	$('a.header-menu-item').closest('li').removeClass('active').find('ul').removeClass('in').attr('aria-expanded','false').attr('style','');;
	if($('.mb-header').hasClass('header-toggle')){
		$('.header-menu-item.active').closest('li').addClass('active').find('ul').addClass('in').attr('aria-expanded','true').attr('style','display:block');
	}
});
$('a.header-menu-item').on('click', function(e){
	$('a.header-menu-item').siblings('ul').slideUp();
	$('a.header-menu-item').closest('li').removeClass('active');
	$(this).closest('li').addClass('active');
	 if ($(this).siblings('ul').attr( 'aria-expanded') === 'true'){
		$(this).closest('li').removeClass('active');
		$(this).siblings('ul').removeClass('in');
		$(this).siblings('ul').attr('aria-expanded','false');
	}else{
		$(this).siblings('ul').slideDown();
		$(this).siblings('ul').addClass('in');
		$('a.header-menu-item').siblings('ul').attr('aria-expanded','false');
		$(this).siblings('ul').attr('aria-expanded','true');
	}
});
/* Mobile Menu open close code End*/

/*Short Link Code Start*/
	$('.short-action-btn').click(function(){
		$('.short-action').toggleClass('active');
	});
	$(document).click(function(event){
	    if (event.target.id == 'short-action' || event.target.id == 'short-action1' || event.target.id == 'short-action2'){
	    }else{
	        $(".short-action").removeClass("active"); 
	    }                   
	});
/*Short Link Code End*/
jQuery(window).scroll(function () {
	if (jQuery(this).scrollTop() > 180) {
		// jQuery('body').toggleClass('sticky-counter')
		jQuery('.scrollToTop').css({ transform: "scale(1)" });
	} else {
		jQuery('.scrollToTop').css({ transform: "scale(0)" });
	}
});
$(window).scroll(function(){
	var sticky = $('body'),
		scroll = $(window).scrollTop();
  
	if (scroll >= 100) sticky.addClass('sticky-counter');
	else sticky.removeClass('sticky-counter');
  });

jQuery('.scrollToTop').click(function () {
	jQuery("html, body").animate({
		scrollTop: 0
	}, 10);
	return false;
});

/* $(window).ready(function(){
	var base_url = $("#js_data").data('base-url');
	var data = {
		status:"broadcast",
	};
    $.ajax({
		url: base_url + 'broadcast/allBroadcastMassage',
		type: 'post',
		data: data,
		success: function(response) {
			var obj = JSON.parse(response);
			console.log(obj);
		}
	});
}); */
$(window).ready(function(){
	var base_url = $("#js_data").data('base-url');
	var id = $("#js_data").data('employee-id');
	var data = {
		status:"password_change",
		id:id,
	};
    $.ajax({
		url: base_url + 'dashboard/checkPassword',
		type: 'post',
		data: data,
		success: function(response){
			var obj = JSON.parse(response);
			if(obj.status == 'match'){
				// obj.employee_detail
				/* $('#user_id').val(obj.employee_detail[0].id);
				$('#pass').val(obj.employee_detail[0].password); */
				$('#changePassword_form1 #user_id').val(obj.employee_detail[0].id);
				$('#changePassword_form1 #pass').val(obj.employee_detail[0].password);
				$('#changePassword').modal('show');
				$('#old_password,#confirm_password,#new_password').val('');
			}
		}
	});
});

function changePassword($id){
	$('.preloader-2').attr('style', 'display:block !important');
	var base_url = $("#js_data").data('base-url');
	var id = $("#"+$id+" #user_id").val();
	var pass = $("#"+$id+" #pass").val();
	var old_password = $("#"+$id+" #old_password").val();
	var new_password = $("#"+$id+" #new_password").val();
	var confirm_password = $("#"+$id+" #confirm_password").val();
	var num = 0;
	if(old_password != ''){
		$("#"+$id+" #old_password").removeClass('error');
	}else{
		$("#"+$id+" #old_password").addClass('error');
		num++;
	}
	if(new_password != ''){
		$("#"+$id+" #new_password").removeClass('error');
	}else{
		$("#"+$id+" #new_password").addClass('error');
		num++;
	}
	if(confirm_password != ''){
		$("#"+$id+" #confirm_password").removeClass('error');
	}else{
		$("#"+$id+" #confirm_password").addClass('error');
		num++;
	}
	if(num == 0){
		var data = {
			status:"password_change",
			old_password:old_password,
			new_password:new_password,
			confirm_password:confirm_password,
			pass:pass,
			id:id,
		};
		$.ajax({
			url: base_url + 'dashboard/changePassword',
			type: 'post',
			data: data,
			success: function(response){
				var obj = JSON.parse(response);
				if(obj.error_code == 0){
					$('#'+$id).modal('hide');
					$('.msg-container').html(obj.message);
					$('.msg-container .msg-box').attr('style','display:block');
					setTimeout(function() {
						$('.msg-container .msg-box').attr('style','display:none');
					}, 6000);
					$('#'+$id+' #old_password,#'+$id+' #confirm_password,#'+$id+' #new_password').val('');
				}else{
					$('.msg-container').html(obj.message);
					$('.msg-container .msg-box').attr('style','display:block');
					setTimeout(function() {
						$('.msg-container .msg-box').attr('style','display:none');
					}, 6000);
				}
				$('.preloader-2').attr('style', 'display:none !important');
			}
		});
	}
}
$('.pass-eye').click(function() {
	var $input = $(this).parent('div').find('input');
	// var id = $(this).data('id');
	if ($(this).hasClass('show')) {
		$(this).removeClass('show');
		// $('#'+id).attr('type', 'password');
		$input.attr('type', 'password');
	} else {
		$(this).addClass('show');
		// $('#'+id).attr('type', 'text');
		$input.attr('type', 'text');
	}
});

/* Start Broadcast */
function openAnnouncmentModal(){
	$('.preloader-2').attr('style', 'display:block !important');
    $('.announcInfo').removeClass('active');
    $('.announcInfo-body').slideUp();
    $('#c-0').parent('div').toggleClass('active');
    $('#c-0').slideToggle(function(){
		$('.preloader-2').attr('style', 'display:none !important');
		$('#announcmentModal').modal('show');
	});
}	
$(document).on('click','.openAnnouncInfo',function(){
    if(!$(this).parent('div').hasClass('active')){
        $('.announcInfo').removeClass('active');
        $('.announcInfo-body').slideUp();
    }
    $(this).parent('div').toggleClass('active');
    $id = $(this).data('target');
    $($id).slideToggle();
});	
/* End Broadcast */